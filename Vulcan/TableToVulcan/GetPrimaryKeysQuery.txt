IF OBJECT_ID('tempdb..#VulcanTMP') IS NOT NULL
    DROP TABLE #VulcanTMP
SELECT I.name, CL.name as ColumnName,is_unique,is_padded,ignore_dup_key,type,Is_Identity,is_primary_key into #VulcanTMP
FROM SYS.INDEXES I INNER JOIN SYS.INDEX_COLUMNS IC ON I.INDEX_ID=IC.INDEX_ID AND I.OBJECT_ID=IC.OBJECT_ID
INNER JOIN SYS.COLUMNS CL ON IC.COLUMN_ID = CL.COLUMN_ID AND IC.OBJECT_ID = CL.OBJECT_ID
WHERE IC.object_id=object_id('@Schema.@Table') and is_disabled=0

IF Exists (SELECT 1 FROM #VulcanTMP WHERE Is_Identity=1 and is_primary_key=1)
SELECT '<Identity Name="'+CAST(name AS nvarchar(255))+'" Unique="'
						+CASE is_unique WHEN 1 THEN 'true' WHEN 0 THEN 'false' END
						+'" Clustered="'+CASE type WHEN 1 THEN 'true' WHEN 2 THEN 'false' END
						+'" IgnoreDupKey="'+CASE ignore_dup_key WHEN 1 THEN 'true' WHEN 0 THEN 'false' END 
						+'" PadIndex="'+CASE is_padded WHEN 1 THEN 'true' WHEN 0 THEN 'false' END +'">
				<Columns>
					<Column ColumnName="'+ ColumnName +'"/>
				</Columns>
			</Identity>' 
	FROM #VulcanTMP WHERE is_identity=1 and is_primary_key =1
ELSE
SELECT	'<PrimaryKey Name="'+CAST(name AS nvarchar(255))+'" Unique="'
						+CASE is_unique WHEN 1 THEN 'true' WHEN 0 THEN 'false' END
						+'" Clustered="'+CASE type WHEN 1 THEN 'true' WHEN 2 THEN 'false' END
						+'" IgnoreDupKey="'+CASE ignore_dup_key WHEN 1 THEN 'true' WHEN 0 THEN 'false' END 
						+'" PadIndex="'+CASE is_padded WHEN 1 THEN 'true' WHEN 0 THEN 'false' END +'">
					<Columns>
					'+ REPLACE(REPLACE((SELECT 
							'<Column ColumnName="'+ColumnName+'"/> ' AS [text()] 
							FROM #VulcanTMP b 
							WHERE a.name=b.name
							FOR XML PATH ('')),'&lt;','<'),'&gt;','>') +'
					</Columns>
			</PrimaryKey>' 
	FROM #VulcanTMP a WHERE is_primary_key=1